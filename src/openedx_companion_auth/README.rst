Open edX auth companion
=======================

An Openedx auth companion plugin that redirects users from edx-platform to MIT applications

Prerequisites
-------------

- Run the following commands to install pants locally:

  .. code-block:: shell

     curl --proto '=https' --tlsv1.2 -fsSL https://static.pantsbuild.org/setup/get-pants.sh | bash

     export PATH=$PATH:/root/.local/bin

Building
--------

- Build a pip-installable package into `dist/`:

  .. code-block:: shell

     pants package ::

Installing
----------

All that is required to install this in either a hosted version of Open edX or devstack is a `pip install` either from PyPI or the output of `poetry build`.

Testing
-------

- Clone the open-edx-plugins repository in the src folder present in the openedx work directory.
- Build the packages using pants:

  .. code-block:: shell

     pants package ::

- In the devstack folder, run:

  .. code-block:: shell

     make lms-shell

- In the lms shell, activate the edxapp virtual environment:

  .. code-block:: shell

     source /edx/app/edxapp/venvs/edxapp/bin/activate

- Install the package generated by pants in the dist folder using pip:

  .. code-block:: shell

     pip install /edx/src/open-edx-plugins/dist/openedx-companion-auth-{version}.tar.gz

- Go to the package directory:

  .. code-block:: shell

     cd open-edx-plugins/src/openedx_companion_auth

- Run tests with pytest:

  .. code-block:: shell

     pytest .  --ds=settings.test
